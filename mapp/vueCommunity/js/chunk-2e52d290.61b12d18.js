(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2e52d290"],{"11e9":function(t,e,s){var i=s("52a7"),n=s("4630"),o=s("6821"),a=s("6a99"),c=s("69a8"),r=s("c69a"),l=Object.getOwnPropertyDescriptor;e.f=s("9e1e")?l:function(t,e){if(t=o(t),e=a(e,!0),r)try{return l(t,e)}catch(s){}if(c(t,e))return n(!i.f.call(t,e),t[e])}},3258:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"details-w"},[s("div",{staticClass:"fixed-title"},[s("span",{staticClass:"cube-icon cubeic-back",on:{click:function(e){return t.$router.go(-1)}}}),s("h3",{staticClass:"title"},[t._v("帖子详情")])]),t.errPublish&&t.isData?s("div",{staticClass:"err-publish"},[t._v("该帖子已被删除")]):t._e(),!t.errPublish&&t.isData?s("div",{staticClass:"content"},[s("div",{staticClass:"title-w"},[!0===t.topiContent.top?s("span",{staticClass:"title-icon"},[t._v("置顶")]):t._e(),s("h3",{staticClass:"title-msg"},[t._v(t._s(t.topiContent.title))])]),t.noLogin?s("div",[t.isCollect?s("div",{staticClass:"collect-w",on:{click:t.collectTopic}},[s("span",{staticClass:"iconfont icon-duomeitiicon-"}),s("span",[t._v("收藏主题")])]):s("div",{staticClass:"collect-w",on:{click:t.deleteCollect}},[s("span",{staticClass:"cube-icon cubeic-like"}),s("span",[t._v("取消收藏")])])]):t._e(),s("div",{staticClass:"label-w"},[s("span",{staticClass:"solid"},[t._v("·")]),t._v("发布于  "+t._s(t.$getDateDiff(t.topiContent.create_at))+"\n      "),s("span",{staticClass:"solid"},[t._v("·")]),t._v("作者 "),t.topiContent.author?s("div",{staticClass:"author",on:{click:function(e){return t.gotoAuthor(t.topiContent.author.loginname)}}},[t._v(t._s(t.topiContent.author.loginname))]):t._e(),s("div",{staticClass:"label-list"},[s("span",{staticClass:"solid"},[t._v("·")]),t._v(t._s(t.topiContent.visit_count)+" 次浏览\n      ")]),s("div",{staticClass:"label-list"},[s("span",{staticClass:"solid"},[t._v("·")]),t._v("来自  "+t._s(t.iconKeywords(t.topiContent.tab))+"\n      ")])]),s("div",{directives:[{name:"highlight",rawName:"v-highlight"}],staticClass:"content-detials",domProps:{innerHTML:t._s(t.topiContent.content)}}),t.repliesData&&t.repliesData.length>0?s("div",{staticClass:"reply-w"},[s("div",{staticClass:"title-l"},[t._v(t._s(t.repliesData.length)+"条回复")]),t.topiContent.replies?s("ul",{staticClass:"reply-uls"},t._l(t.repliesData,function(e,i){return s("li",{key:i,ref:"replyList",refInFor:!0,staticClass:"reply-list"},[s("div",{staticClass:"list-top"},[e.author?s("div",{staticClass:"left"},[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.author.avatar_url,expression:"item.author.avatar_url"}],staticClass:"img",attrs:{alt:""}}),s("span",{staticClass:"name"},[t._v(t._s(e.author.loginname)+" ")]),s("span",{staticClass:"time"},[t._v(t._s(i+1)+"楼 • "+t._s(t.$getDateDiff(e.create_at)))])]):t._e(),t.noLogin?s("div",{staticClass:"right"},[s("div",{staticClass:"good-t",on:{click:function(s){return t.upsGood(e.id,i)}}},[s("span",{class:{"cube-icon cubeic-good":e.ups.length>0,"iconfont icon-dianzan":0===e.ups.length}}),s("span",{staticClass:"numUps"},[t._v(t._s(e.ups.length))])]),s("span",{staticClass:"cube-icon cubeic-message",on:{click:function(s){return t.showCont(e,i)}}})]):t._e()]),s("p",{staticClass:"reply-desc",domProps:{innerHTML:t._s(e.content)}}),t.replyShowIndex===i&&t.replyShow?s("div",{staticClass:"my-reply-import"},[s("div",{staticClass:"text-w"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.importContent,expression:"importContent"}],domProps:{value:t.importContent},on:{input:function(e){e.target.composing||(t.importContent=e.target.value)}}})]),s("div",{staticClass:"btn-w"},[s("div",{staticClass:"btn-list",on:{click:function(s){return t.replyOther(e)}}},[t._v("回复")]),s("div",{staticClass:"btn-list",on:{click:t.cancelReply}},[t._v("取消")])])]):t._e()])}),0):t._e()]):t._e(),t.noLogin?s("div",{staticClass:"my-reply"},[s("div",{staticClass:"title-l"},[t._v("添加回复")]),s("div",{staticClass:"mark-w"},[s("label",{attrs:{for:""}}),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.repContent,expression:"repContent"}],staticClass:"textarea",attrs:{placeholder:"请输入回复内容..."},domProps:{value:t.repContent},on:{input:function(e){e.target.composing||(t.repContent=e.target.value)}}})]),s("div",{staticClass:"btn-w"},[s("div",{staticClass:"btn-send",class:{"loading-btn":t.isLoading},on:{click:t.replies}},[s("span",{staticClass:"cube-icon cubeic-navigation"}),s("span",{staticClass:"rep-t"},[t._v("回复")]),s("cube-loading",{directives:[{name:"show",rawName:"v-show",value:t.isLoading,expression:"isLoading"}]})],1)])]):t._e()]):t._e(),s("div",{directives:[{name:"show",rawName:"v-show",value:t.axaShow,expression:"axaShow"}],staticClass:"fixed-dialog"},[t._m(0)])])},n=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ball-pulse"},[s("div"),s("div"),s("div")])}],o=(s("ac6a"),s("c5f6"),s("ae4d")),a=s.n(o),c={data:function(){return{axaShow:!1,replyShow:!1,replyShowIndex:-1,importContent:"",repliesData:[],isLoading:!1,repContent:"",isData:!1,errPublish:!1,isCollect:!0,topiContent:"",noLogin:!1,accesstoken:"",topic_id:this.$route.query.id}},created:function(){this.getDetails(),this.getUserInfo(),this.accesstoken=localStorage.getItem("__accesstoken__"),this.accesstoken?this.noLogin=!0:this.noLogin=!1},methods:{gotoAuthor:function(t){this.$router.push({path:"/personalCenter",query:{author:t}})},showCont:function(t,e){-1===this.replyShowIndex&&!1===this.replyShow?(this.importContent="@".concat(t.author.loginname," "),this.replyShowIndex=e,this.replyShow=!0):!0===this.replyShow&&this.replyShowIndex!==e?(this.importContent="@".concat(t.author.loginname," "),this.replyShowIndex=e,this.replyShow=!0):(this.importContent="",this.replyShowIndex=-1,this.replyShow=!1)},cancelReply:function(){this.replyShowIndex=-1,this.replyShow=!1,this.importContent=""},replyOther:function(t){var e=this;""===this.importContent.trim()?this.$createDialog({type:"alert",title:"请输入评论内容"}).show():(this.axaShow=!0,this.$fetch.post("/topic/".concat(this.topic_id,"/replies"),{accesstoken:this.accesstoken,content:this.importContent,reply_id:t.id}).then(function(t){e.axaShow=!1,e.importContent="",e.replyShowIndex=-1,e.replyShow=!1,t.success&&e.getDetails()}).catch(function(){e.axaShow=!1}))},replies:function(){var t=this;if(""===this.repContent.trim())this.$createDialog({type:"alert",title:"请输入评论内容"}).show();else{this.isLoading=!0;var e=new a.a.Renderer;a.a.setOptions({renderer:e,gfm:!0,tables:!0,breaks:!0,pedantic:!1,sanitize:!1,smartLists:!0,smartypants:!1});var s=a()(this.repContent);this.$fetch.post("/topic/".concat(this.topic_id,"/replies"),{accesstoken:this.accesstoken,content:s}).then(function(e){t.repContent="",t.isLoading=!1,e.success&&t.getDetails()}).catch(function(e){e.error_msg.indexOf("not found")>-1&&t.$createDialog({type:"alert",title:"该帖子已被删除"}).show()})}},iconKeywords:function(t){var e=t;return"good"===e?"精华":"weex"===e?"weex":"share"===e?"分享":"ask"===e?"问答":"job"===e?"招聘":void 0},collectTopic:function(){var t=this;this.$fetch.post("/topic/collect",{accesstoken:this.accesstoken,topic_id:this.topiContent.id}).then(function(e){e.success&&(t.isCollect=!1)})},deleteCollect:function(){var t=this;this.$fetch.post("/topic/de_collect",{accesstoken:this.accesstoken,topic_id:this.topiContent.id}).then(function(e){e.success&&(t.isCollect=!0)})},upsGood:function(t,e){var s=this;this.$fetch.post("/reply/".concat(t,"/ups"),{accesstoken:this.accesstoken}).then(function(t){if(t.success){var i;i=s.$refs.replyList[e].getElementsByClassName("numUps")[0].innerHTML,s.$refs.replyList[e].getElementsByClassName("good-t")[0].children[0].className="","down"===t.action?(s.$refs.replyList[e].getElementsByClassName("numUps")[0].innerHTML=Number(i)-1,0===Number(s.$refs.replyList[e].getElementsByClassName("numUps")[0].innerHTML)?s.$refs.replyList[e].getElementsByClassName("good-t")[0].children[0].className="iconfont icon-dianzan":s.$refs.replyList[e].getElementsByClassName("good-t")[0].children[0].className="cube-icon cubeic-good"):(s.$refs.replyList[e].getElementsByClassName("numUps")[0].innerHTML=Number(i)+1,s.$refs.replyList[e].getElementsByClassName("good-t")[0].children[0].className="cube-icon cubeic-good my-good")}else{var n=s.$createToast({txt:t.error_msg,time:2e3,type:"txt"});n.show()}})},getUserInfo:function(){var t=this,e=localStorage.getItem("__userName__");e&&this.$fetch.get("/user/".concat(e)).then(function(e){var s=e.data.collect_topics;s.forEach(function(e){e.id===t.topiContent.id&&(t.isCollect=!1)})})},getDetails:function(){var t=this;this.$fetch.get("/topic/".concat(this.topic_id)).then(function(e){if(t.isData=!0,e.data){t.topiContent=e.data;var s=e.data.replies;setTimeout(function(){s.forEach(function(e,s){t.$refs.replyList&&e.ups.forEach(function(e){e===localStorage.getItem("__userId__")&&(t.$refs.replyList[s].getElementsByClassName("good-t")[0].children[0].className="cube-icon cubeic-good my-good")})}),t.repliesData=s},500)}else t.errPublish=!0})}}},r=c,l=(s("823d"),s("2877")),p=Object(l["a"])(r,i,n,!1,null,"d2fe187c",null);e["default"]=p.exports},"5dbc":function(t,e,s){var i=s("d3f4"),n=s("8b97").set;t.exports=function(t,e,s){var o,a=e.constructor;return a!==s&&"function"==typeof a&&(o=a.prototype)!==s.prototype&&i(o)&&n&&n(t,o),t}},"823d":function(t,e,s){"use strict";var i=s("f906"),n=s.n(i);n.a},"8b97":function(t,e,s){var i=s("d3f4"),n=s("cb7c"),o=function(t,e){if(n(t),!i(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,i){try{i=s("9b43")(Function.call,s("11e9").f(Object.prototype,"__proto__").set,2),i(t,[]),e=!(t instanceof Array)}catch(n){e=!0}return function(t,s){return o(t,s),e?t.__proto__=s:i(t,s),t}}({},!1):void 0),check:o}},9093:function(t,e,s){var i=s("ce10"),n=s("e11e").concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,n)}},aa77:function(t,e,s){var i=s("5ca1"),n=s("be13"),o=s("79e5"),a=s("fdef"),c="["+a+"]",r="​",l=RegExp("^"+c+c+"*"),p=RegExp(c+c+"*$"),u=function(t,e,s){var n={},c=o(function(){return!!a[t]()||r[t]()!=r}),l=n[t]=c?e(h):a[t];s&&(n[s]=l),i(i.P+i.F*c,"String",n)},h=u.trim=function(t,e){return t=String(n(t)),1&e&&(t=t.replace(l,"")),2&e&&(t=t.replace(p,"")),t};t.exports=u},c5f6:function(t,e,s){"use strict";var i=s("7726"),n=s("69a8"),o=s("2d95"),a=s("5dbc"),c=s("6a99"),r=s("79e5"),l=s("9093").f,p=s("11e9").f,u=s("86cc").f,h=s("aa77").trim,d="Number",f=i[d],v=f,C=f.prototype,m=o(s("2aeb")(C))==d,g="trim"in String.prototype,_=function(t){var e=c(t,!1);if("string"==typeof e&&e.length>2){e=g?e.trim():h(e,3);var s,i,n,o=e.charCodeAt(0);if(43===o||45===o){if(s=e.charCodeAt(2),88===s||120===s)return NaN}else if(48===o){switch(e.charCodeAt(1)){case 66:case 98:i=2,n=49;break;case 79:case 111:i=8,n=55;break;default:return+e}for(var a,r=e.slice(2),l=0,p=r.length;l<p;l++)if(a=r.charCodeAt(l),a<48||a>n)return NaN;return parseInt(r,i)}}return+e};if(!f(" 0o1")||!f("0b1")||f("+0x1")){f=function(t){var e=arguments.length<1?0:t,s=this;return s instanceof f&&(m?r(function(){C.valueOf.call(s)}):o(s)!=d)?a(new v(_(e)),s,f):_(e)};for(var y,w=s("9e1e")?l(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),b=0;w.length>b;b++)n(v,y=w[b])&&!n(f,y)&&u(f,y,p(v,y));f.prototype=C,C.constructor=f,s("2aba")(i,d,f)}},f906:function(t,e,s){},fdef:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);